<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADHD多维度专业筛查量表</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== CSS样式部分（保持绝对稳定，仅修改颜色主题） ========== */
        :root {
            --primary-color: #3a7bd5;
            --secondary-color: #00d2ff;
            --success-color: #4CAF50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --light-bg: #f8fafc;
            --card-bg: #ffffff;
            --text-dark: #2d3748;
            --text-light: #718096;
            --border-color: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f4f8 0%, #e6f0fa 100%);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(50, 100, 150, 0.08);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto;
        }

        .meta-info {
            background-color: #e8f4fc;
            padding: 15px 30px;
            color: var(--text-light);
            font-size: 0.9rem;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            border-bottom: 1px solid var(--border-color);
        }

        .meta-item {
            margin: 5px 15px;
        }

        .meta-item i {
            margin-right: 8px;
            color: var(--primary-color);
        }

        .disclaimer {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            margin: 25px;
            padding: 20px;
            border-radius: 10px;
            color: #856404;
            font-size: 0.95rem;
        }

        .disclaimer strong {
            color: #d39e00;
        }

        .progress-container {
            padding: 0 30px;
            margin-top: 20px;
        }

        .progress-bar {
            height: 8px;
            background-color: #edf2f7;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress {
            height: 100%;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .progress-text {
            text-align: right;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .questions-container {
            padding: 30px;
        }

        .question-card {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            display: none;
        }

        .question-card.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .question-number {
            background-color: var(--primary-color);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
            line-height: 1.5;
            flex-grow: 1;
            margin-left: 15px;
        }

        .options-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        .option-btn {
            padding: 16px 20px;
            background-color: white;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
            font-weight: 500;
            color: var(--text-dark);
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover {
            border-color: var(--primary-color);
            background-color: #f0f7ff;
            transform: translateY(-2px);
        }

        .option-btn.selected {
            border-color: var(--primary-color);
            background-color: #e8f4ff;
            color: var(--primary-color);
            font-weight: 600;
        }

        .option-btn.selected::after {
            content: '✓';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-weight: bold;
        }

        .score-label {
            display: block;
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: normal;
        }

        .buttons-container {
            padding: 0 30px 30px;
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .nav-btn, .submit-btn {
            padding: 16px 30px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
        }

        .nav-btn {
            background-color: #edf2f7;
            color: var(--text-dark);
        }

        .nav-btn:hover {
            background-color: #e2e8f0;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-btn i {
            margin: 0 8px;
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: 0 4px 12px rgba(58, 123, 213, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(58, 123, 213, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .result-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .result-content {
            background-color: white;
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalFadeIn 0.5s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            border-radius: 20px 20px 0 0;
            text-align: center;
        }

        .result-body {
            padding: 30px;
        }

        .score-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .score-card {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .score-value {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1;
            margin-bottom: 10px;
        }

        .score-label {
            font-size: 1rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        .interpretation {
            background-color: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            border-left: 4px solid var(--primary-color);
        }

        .interpretation h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .result-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .result-btn {
            flex: 1;
            padding: 16px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }

        .restart-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .restart-btn:hover {
            background-color: #2a6bc4;
        }

        .close-btn {
            background-color: #edf2f7;
            color: var(--text-dark);
        }

        .close-btn:hover {
            background-color: #e2e8f0;
        }

        footer {
            text-align: center;
            padding: 25px;
            color: var(--text-light);
            font-size: 0.9rem;
            border-top: 1px solid var(--border-color);
            background-color: #f9fbfd;
        }

        @media (max-width: 768px) {
            header h1 { font-size: 2rem; }
            .subtitle { font-size: 1rem; }
            .options-container { grid-template-columns: 1fr; }
            .buttons-container { flex-direction: column; }
            .nav-btn, .submit-btn { width: 100%; }
            .score-cards { grid-template-columns: 1fr; }
            .result-buttons { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-brain"></i> ADHD多维度专业筛查量表</h1>
            <p class="subtitle">本测评整合了SNAP-IV核心维度及常见行为表现，旨在提供专业、便捷的数字化初步筛查参考。包含注意、多动、冲动及行为问题评估。</p>
        </header>

        <div class="meta-info">
            <div class="meta-item"><i class="fas fa-clock"></i> 预计时间：8-10分钟</div>
            <div class="meta-item"><i class="fas fa-question-circle"></i> 题目数量：30题</div>
            <div class="meta-item"><i class="fas fa-user-check"></i> 适用对象：6-18岁儿童青少年</div>
            <div class="meta-item"><i class="fas fa-stethoscope"></i> 评估人：父母或主要抚养者</div>
        </div>

        <div class="disclaimer">
            <p><strong><i class="fas fa-exclamation-triangle"></i> 重要提示：</strong>本测评结果为初步筛查参考，<strong>不能替代</strong>专业医生的临床诊断。若结果提示异常，建议携带此结果咨询<strong>儿童精神科、发育行为儿科或心理科医生</strong>，以获取权威评估和干预指导。</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
            <div class="progress-text">进度：<span id="progressText">0</span>/30</div>
        </div>

        <div class="questions-container" id="questionsContainer">
            <!-- 问题卡片将通过JavaScript动态生成 -->
        </div>

        <div class="buttons-container">
            <button class="nav-btn" id="prevBtn" onclick="prevQuestion()" disabled>
                <i class="fas fa-arrow-left"></i> 上一题
            </button>
            <button class="nav-btn" id="nextBtn" onclick="nextQuestion()">
                下一题 <i class="fas fa-arrow-right"></i>
            </button>
            <button class="submit-btn" id="submitBtn" onclick="submitTest()" disabled>
                <i class="fas fa-paper-plane"></i> 提交并查看结果
            </button>
        </div>

        <footer>
            <p>© 2023 儿童发展评估工具 | 本量表基于DSM-5诊断标准及SNAP-IV等常用临床量表整合设计 | 结果仅供参考</p>
            <p style="margin-top: 8px; font-size: 0.8rem;"><i class="fas fa-heartbeat"></i> 科学评估，理解孩子，助力成长</p>
        </footer>
    </div>

    <!-- 结果弹窗 -->
    <div class="result-modal" id="resultModal">
        <div class="result-content">
            <div class="result-header">
                <h2><i class="fas fa-chart-line"></i> 测评结果分析报告</h2>
                <p>基于您提供的回答，以下是量表的分析结果</p>
            </div>
            <div class="result-body">
                <div class="score-cards" id="scoreCardsContainer">
                    <!-- 分数卡片将通过JavaScript动态生成 -->
                </div>
                <div class="interpretation" id="interpretationContainer">
                    <!-- 解读内容将通过JavaScript动态生成 -->
                </div>
                <div class="result-buttons">
                    <button class="result-btn restart-btn" onclick="restartTest()">
                        <i class="fas fa-redo"></i> 重新开始测评
                    </button>
                    <button class="result-btn close-btn" onclick="closeResult()">
                        <i class="fas fa-times"></i> 关闭结果
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== JavaScript代码部分（核心修改区） ==========
        // 1. 修改题目数据
        const adhdQuestions = {
            scale: "ADHD多维度筛查量表 (SNAP-IV简化版)",
            description: "评估注意力不集中、多动冲动及常见行为问题的核心表现",
            items: [
                // 注意维度 (1-9)
                { id: 1, text: "在做作业或其他活动时，不能密切关注细节或犯粗心大意的错误。", dimension: "注意" },
                { id: 2, text: "在任务或游戏活动中难以维持注意力（如听课、阅读时走神）。", dimension: "注意" },
                { id: 3, text: "当别人对其直接讲话时，好像看起来没有在听（显得心不在焉）。", dimension: "注意" },
                { id: 4, text: "不能始终遵循指示，无法按要求完成作业、家务等任务。", dimension: "注意" },
                { id: 5, text: "难以组织/规划任务和活动（做事凌乱、时间管理差）。", dimension: "注意" },
                { id: 6, text: "回避、厌恶或不情愿从事需要持续用脑的任务（如学校作业）。", dimension: "注意" },
                { id: 7, text: "丢失任务或活动所必需的物品（作业、文具、钥匙等）。", dimension: "注意" },
                { id: 8, text: "容易被外界的刺激分神（或产生不相关的想法）。", dimension: "注意" },
                { id: 9, text: "在日常活动中忘记事情（家务、约定等）。", dimension: "注意" },
                // 多动维度 (10-14)
                { id: 10, text: "手脚动作不停或在座位上扭动。", dimension: "多动" },
                { id: 11, text: "当被期待坐在座位上时却离座（如离开教室）。", dimension: "多动" },
                { id: 12, text: "在不适当的场合跑来跑去或爬上爬下（或感到坐立不安）。", dimension: "多动" },
                { id: 13, text: "很难安静地玩耍或从事休闲活动（总要发出声音）。", dimension: "多动" },
                { id: 14, text: "一直‘忙个不停’，好像‘被发动机驱动着’。", dimension: "多动" },
                // 冲动维度 (15-18)
                { id: 15, text: "讲话过多（多言多语，一直说个不停）。", dimension: "冲动" },
                { id: 16, text: "在提问还没有讲完之前就把答案脱口而出（抢话、抢答）。", dimension: "冲动" },
                { id: 17, text: "在排队等待时，难以等待轮到他/她。", dimension: "冲动" },
                { id: 18, text: "打断或侵扰他人（插入对话、游戏，未经允许用他人物品）。", dimension: "冲动" },
                // 常见行为问题 (19-30) - 综合自其他量表
                { id: 19, text: "与大人争论，倾向于对抗或拒绝遵守大人的要求与规定。", dimension: "行为" },
                { id: 20, text: "发脾气，情绪突然变化，容易激惹。", dimension: "行为" },
                { id: 21, text: "故意惹恼别人，自己有错误却怪罪于别人。", dimension: "行为" },
                { id: 22, text: "坐立不安，总想站起来，总在活动，很难长期静坐。", dimension: "行为" },
                { id: 23, text: "容易与别的儿童打架或争吵。", dimension: "行为" },
                { id: 24, text: "做事有始无终，不能坚持完成任务。", dimension: "行为" },
                { id: 25, text: "学习有困难，注意力不集中或注意广度有问题。", dimension: "行为" },
                { id: 26, text: "不服从或勉强服从但不满，经常需要管教。", dimension: "行为" },
                { id: 27, text: "干扰别的孩子，不被其他儿童喜欢。", dimension: "行为" },
                { id: 28, text: "行为幼稚与其年龄不符，需要别人经常注意自己。", dimension: "行为" },
                { id: 29, text: "过度恐惧或担心，对许多事都心烦。", dimension: "行为" },
                { id: 30, text: "睡眠有问题（难以入睡、夜间易醒）或早上赖床。", dimension: "行为" }
            ]
        };

        // 评分选项 (0-3分)
        const ratingOptions = [
            { text: "没有", score: 0, desc: "从未发生或不符合" },
            { text: "偶尔", score: 1, desc: "每周少于1次" },
            { text: "常常", score: 2, desc: "每周至少1-2次" },
            { text: "总是", score: 3, desc: "几乎每天发生" }
        ];

        // ========== 以下是稳定不变的逻辑部分，请勿修改 ==========
        let currentQuestion = 0;
        let userAnswers = new Array(adhdQuestions.items.length).fill(null);

        // 初始化问题
        function initializeQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            adhdQuestions.items.forEach((q, index) => {
                const questionCard = document.createElement('div');
                questionCard.className = `question-card ${index === 0 ? 'active' : ''}`;
                questionCard.id = `q${index}`;

                let optionsHTML = '';
                ratingOptions.forEach(option => {
                    optionsHTML += `
                        <div class="option-btn" onclick="selectOption(${index}, ${option.score})">
                            ${option.text}
                            <span class="score-label">${option.desc} (${option.score}分)</span>
                        </div>
                    `;
                });

                questionCard.innerHTML = `
                    <div class="question-header">
                        <div class="question-number">${q.id}</div>
                        <div class="question-text">${q.text}</div>
                    </div>
                    <div class="options-container">
                        ${optionsHTML}
                    </div>
                `;
                container.appendChild(questionCard);
            });

            updateProgress();
            updateButtons();
        }

        // 选择选项
        function selectOption(qIndex, score) {
            // 清除同一问题下其他选项的选中状态
            const questionCard = document.getElementById(`q${qIndex}`);
            const allOptions = questionCard.querySelectorAll('.option-btn');
            allOptions.forEach(opt => opt.classList.remove('selected'));

            // 设置当前选项为选中状态
            const selectedOption = Array.from(allOptions).find(opt => {
                const btnText = opt.textContent.split('\n')[0].trim();
                const matchingOption = ratingOptions.find(o => o.text === btnText);
                return matchingOption && matchingOption.score === score;
            });
            if (selectedOption) selectedOption.classList.add('selected');

            userAnswers[qIndex] = score;
            updateProgress();
            updateButtons();

            // 自动跳转到下一题（如果不是最后一题）
            if (qIndex === currentQuestion && qIndex < adhdQuestions.items.length - 1) {
                setTimeout(() => nextQuestion(), 300);
            }
        }

        // 更新进度条
        function updateProgress() {
            const answeredCount = userAnswers.filter(ans => ans !== null).length;
            const totalQuestions = adhdQuestions.items.length;
            const progressPercent = (answeredCount / totalQuestions) * 100;

            document.getElementById('progressBar').style.width = `${progressPercent}%`;
            document.getElementById('progressText').textContent = `${answeredCount}/${totalQuestions}`;

            // 更新提交按钮状态
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = answeredCount < totalQuestions;
        }

        // 更新导航按钮
        function updateButtons() {
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('nextBtn').disabled = currentQuestion === adhdQuestions.items.length - 1;
        }

        // 上一题
        function prevQuestion() {
            if (currentQuestion > 0) {
                document.getElementById(`q${currentQuestion}`).classList.remove('active');
                currentQuestion--;
                document.getElementById(`q${currentQuestion}`).classList.add('active');
                updateButtons();
            }
        }

        // 下一题
        function nextQuestion() {
            if (currentQuestion < adhdQuestions.items.length - 1) {
                document.getElementById(`q${currentQuestion}`).classList.remove('active');
                currentQuestion++;
                document.getElementById(`q${currentQuestion}`).classList.add('active');
                updateButtons();
            }
        }

        // ========== 核心修改区：计算分数和生成结果的逻辑 ==========
        function calculateScore() {
            const answers = userAnswers;
            let attentionScore = 0, hyperScore = 0, impulseScore = 0, behaviorScore = 0;
            let attentionItems = 0, hyperItems = 0, impulseItems = 0, behaviorItems = 0;

            adhdQuestions.items.forEach((item, index) => {
                const score = answers[index] || 0;
                switch(item.dimension) {
                    case "注意":
                        attentionScore += score;
                        attentionItems++;
                        break;
                    case "多动":
                        hyperScore += score;
                        hyperItems++;
                        break;
                    case "冲动":
                        impulseScore += score;
                        impulseItems++;
                        break;
                    case "行为":
                        behaviorScore += score;
                        behaviorItems++;
                        break;
                }
            });

            // 计算平均分（每题最高3分）
            const attentionAvg = attentionItems > 0 ? (attentionScore / attentionItems).toFixed(2) : 0;
            const hyperAvg = hyperItems > 0 ? (hyperScore / hyperItems).toFixed(2) : 0;
            const impulseAvg = impulseItems > 0 ? (impulseScore / impulseItems).toFixed(2) : 0;
            const behaviorAvg = behaviorItems > 0 ? (behaviorScore / behaviorItems).toFixed(2) : 0;
            const totalAvg = ((attentionScore + hyperScore + impulseScore + behaviorScore) / adhdQuestions.items.length).toFixed(2);

            // 判断风险等级 (基于SNAP-IV常用切分点: 平均分1.6以上为中度风险)
            function getRiskLevel(avgScore) {
                if (avgScore >= 2.0) return { level: "高风险", color: "#f44336" };
                if (avgScore >= 1.6) return { level: "中度风险", color: "#ff9800" };
                if (avgScore >= 1.0) return { level: "边缘状态", color: "#ffc107" };
                return { level: "正常范围", color: "#4CAF50" };
            }

            const attentionRisk = getRiskLevel(attentionAvg);
            const hyperRisk = getRiskLevel(hyperAvg);
            const impulseRisk = getRiskLevel(impulseAvg);
            const behaviorRisk = getRiskLevel(behaviorAvg);
            const totalRisk = getRiskLevel(totalAvg);

            return {
                scores: {
                    注意: { score: attentionScore, avg: attentionAvg, risk: attentionRisk, items: attentionItems },
                    多动: { score: hyperScore, avg: hyperAvg, risk: hyperRisk, items: hyperItems },
                    冲动: { score: impulseScore, avg: impulseAvg, risk: impulseRisk, items: impulseItems },
                    行为: { score: behaviorScore, avg: behaviorAvg, risk: behaviorRisk, items: behaviorItems },
                    总分: { score: attentionScore + hyperScore + impulseScore + behaviorScore, avg: totalAvg, risk: totalRisk, items: adhdQuestions.items.length }
                }
            };
        }

        // 生成结果报告
        function generateResultReport(result) {
            const scoreCardsContainer = document.getElementById('scoreCardsContainer');
            const interpretationContainer = document.getElementById('interpretationContainer');

            // 1. 生成分数卡片
            let scoreCardsHTML = '';
            for (const [dimension, data] of Object.entries(result.scores)) {
                scoreCardsHTML += `
                    <div class="score-card">
                        <div class="score-value" style="color: ${data.risk.color};">${data.avg}</div>
                        <div class="score-label" style="font-weight: 600; color: ${data.risk.color};">${data.risk.level}</div>
                        <div class="score-label">${dimension}维度</div>
                        <div class="score-label">(${data.score}分 / ${data.items * 3}分)</div>
                    </div>
                `;
            }
            scoreCardsContainer.innerHTML = scoreCardsHTML;

            // 2. 生成解读文本
            const totalRisk = result.scores.总分.risk.level;
            let interpretationText = '';

            if (totalRisk === "高风险" || totalRisk === "中度风险") {
                interpretationText = `
                    <h3><i class="fas fa-exclamation-circle"></i> 筛查结果提示：存在明显ADHD相关症状风险</h3>
                    <p>根据您的评估，孩子在<strong>注意力、多动/冲动及行为管理</strong>等多个维度上表现出中度至高度的困难，与ADHD（注意缺陷多动障碍）的核心症状有较高吻合度。</p>
                    <p><strong>建议行动：</strong></p>
                    <ul>
                        <li><strong>寻求专业评估：</strong>强烈建议您携带此结果，预约<strong>儿童精神科、发育行为儿科或心理科</strong>进行全面的临床诊断评估。专业的诊断是获得有效帮助的第一步。</li>
                        <li><strong>收集日常信息：</strong>就诊前，记录孩子在学校和家庭中的具体行为表现、发生频率和情境，有助于医生更准确判断。</li>
                        <li><strong>了解支持资源：</strong>ADHD可以通过行为治疗、家长培训、学校干预以及必要时在医生指导下的药物治疗进行有效管理。</li>
                    </ul>
                `;
            } else if (totalRisk === "边缘状态") {
                interpretationText = `
                    <h3><i class="fas fa-info-circle"></i> 筛查结果提示：处于边缘状态</h3>
                    <p>评估显示孩子在部分维度（如${getHighestDimension(result.scores)}）存在一定困难，但尚未达到典型的临床水平。这可能是发展过程中的波动，或受环境、情绪等因素暂时影响。</p>
                    <p><strong>建议行动：</strong></p>
                    <ul>
                        <li><strong>持续观察：</strong>在接下来的1-3个月内，有意识地观察孩子在相关情境下的表现是否有变化。</li>
                        <li><strong>优化环境支持：</strong>尝试提供更结构化的日常安排、减少干扰、分解任务、给予清晰指令和及时正向反馈。</li>
                        <li><strong>如有疑虑，可咨询：</strong>如果困难持续存在或影响到学习、社交，仍建议咨询相关专业人士获取指导。</li>
                    </ul>
                `;
            } else {
                interpretationText = `
                    <h3><i class="fas fa-check-circle"></i> 筛查结果提示：正常范围内</h3>
                    <p>根据当前评估，孩子在注意力、活动水平和行为控制方面的表现总体在正常发展范围之内。未发现明显的ADHD核心症状。</p>
                    <p><strong>说明与建议：</strong></p>
                    <ul>
                        <li>本结果为基于近期行为的筛查，不能完全排除未来出现变化的可能性。</li>
                        <li>继续保持良好的亲子沟通和积极的教养方式。如果未来出现新的、持续性的困扰，可重新评估或咨询专业人士。</li>
                        <li>每个孩子都有独特的发展节奏和气质，接纳个体差异，关注优势发展。</li>
                    </ul>
                `;
            }

            interpretationContainer.innerHTML = interpretationText;
        }

        // 辅助函数：获取分数最高的维度
        function getHighestDimension(scores) {
            let highestDim = '';
            let highestAvg = 0;
            for (const [dim, data] of Object.entries(scores)) {
                if (dim !== '总分' && parseFloat(data.avg) > highestAvg) {
                    highestAvg = parseFloat(data.avg);
                    highestDim = dim;
                }
            }
            return highestDim || '某些';
        }

        // 提交测试
        function submitTest() {
            const allAnswered = userAnswers.every(ans => ans !== null);
            if (!allAnswered) {
                alert('请完成所有题目后再提交。');
                return;
            }

            const result = calculateScore();
            generateResultReport(result);

            // 显示结果弹窗
            document.getElementById('resultModal').style.display = 'flex';
            // 滚动到顶部
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 重新开始测试
        function restartTest() {
            if (confirm('确定要重新开始测评吗？当前答案将被清空。')) {
                userAnswers = new Array(adhdQuestions.items.length).fill(null);
                currentQuestion = 0;
                closeResult();
                initializeQuestions();
                // 滚动到顶部
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // 关闭结果弹窗
        function closeResult() {
            document.getElementById('resultModal').style.display = 'none';
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            initializeQuestions();
            // 允许回车键翻页
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    if (currentQuestion < adhdQuestions.items.length - 1) {
                        nextQuestion();
                    } else {
                        const submitBtn = document.getElementById('submitBtn');
                        if (!submitBtn.disabled) submitTest();
                    }
                }
            });
        });
    </script>
</body>
</html>
