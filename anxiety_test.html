<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>焦虑测评系统</title>
    <style>
        /* 样式代码...（保持原有的CSS，大约300行） */
        /* 为了节省空间，这里不重复，用你已有的CSS */
    </style>
</head>
<body>
    <div class="container">
        <!-- HTML结构...（保持原有的HTML） -->
        <!-- 为了节省空间，这里不重复，用你已有的HTML结构 -->
    </div>
    
    <script>
        // ===== 完整的JavaScript代码 =====
        // 焦虑测评数据
        const anxietyQuestions = [
            {
                scale: "GAD-7广泛性焦虑量表",
                items: ["1. 感到紧张、焦虑或急切", "2. 不能停止或控制担忧", "3. 对各种各样的事情担忧过多", "4. 很难放松下来", "5. 由于不安而无法静坐", "6. 变得容易烦恼或急躁", "7. 感到似乎将有可怕的事情发生而害怕"]
            },
            {
                scale: "SAS焦虑自评量表", 
                items: ["8. 我觉得比平时容易紧张和着急", "9. 我无缘无故地感到害怕", "10. 我容易心里烦乱或觉得惊恐", "11. 我觉得我可能将要发疯", "12. 我觉得一切都很好", "13. 我手脚发抖打颤", "14. 我因为头痛而苦恼", "15. 我感觉容易衰弱和疲乏", "16. 我觉得心平气和", "17. 我觉得心跳很快", "18. 我因为头晕而苦恼", "19. 我有晕倒发作", "20. 我呼气吸气都感到很容易", "21. 我手脚麻木和刺痛", "22. 我因为胃痛而苦恼", "23. 我常常要小便", "24. 我的手常常是干燥温暖的", "25. 我脸红发热", "26. 我容易入睡", "27. 我做恶梦"]
            },
            {
                scale: "BAI贝克焦虑量表",
                items: ["28. 麻木或刺痛感", "29. 感到发热", "30. 腿部颤抖", "31. 不能放松", "32. 害怕发生不好的事情", "33. 头晕", "34. 心悸", "35. 心神不定", "36. 惊吓", "37. 紧张", "38. 窒息感", "39. 手发抖", "40. 身体摇晃感", "41. 害怕失控", "42. 呼吸困难", "43. 害怕快要死去", "44. 恐慌", "45. 消化不良", "46. 昏厥感", "47. 脸发红", "48. 出汗"]
            }
        ];

        let userAnswers = {};
        
        // 初始化题目
        function initializeQuestions() {
            const container = document.getElementById('questionnaire');
            if (!container) return;
            container.innerHTML = '';
            
            anxietyQuestions.forEach((scaleData, scaleIndex) => {
                // 创建量表标题
                const title = document.createElement('div');
                title.className = 'scale-title';
                title.innerHTML = `<h3>${scaleData.scale}</h3>`;
                container.appendChild(title);
                
                // 创建题目
                scaleData.items.forEach((itemText, itemIndex) => {
                    const qNum = scaleIndex * 20 + itemIndex + 1;
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question-item';
                    questionDiv.innerHTML = `
                        <div class="question-text">${itemText}</div>
                        <div class="options">
                            <button class="option-btn" onclick="selectOption('q${qNum}', 1)">1分</button>
                            <button class="option-btn" onclick="selectOption('q${qNum}', 2)">2分</button>
                            <button class="option-btn" onclick="selectOption('q${qNum}', 3)">3分</button>
                            <button class="option-btn" onclick="selectOption('q${qNum}', 4)">4分</button>
                        </div>
                    `;
                    container.appendChild(questionDiv);
                });
            });
        }
        
        // 选择选项
        function selectOption(qId, value) {
            userAnswers[qId] = value;
            updateProgress();
            alert(`已选择第${qId.substring(1)}题：${value}分`);
        }
        
        // 更新进度
        function updateProgress() {
            const total = 48;
            const answered = Object.keys(userAnswers).length;
            const percent = Math.round((answered / total) * 100);
            
            const bar = document.getElementById('progressBar');
            const text = document.getElementById('progressPercent');
            if (bar) bar.style.width = percent + '%';
            if (text) text.textContent = `${percent}% (${answered}/48)`;
        }
        
        // 检查完成情况
        function checkCompletion() {
            const answered = Object.keys(userAnswers).length;
            alert(`已完成 ${answered}/48 题`);
        }
        
        // 计算分数
        function calculateScore() {
            const answered = Object.keys(userAnswers).length;
            if (answered < 48) {
                alert(`请完成所有48题！当前完成：${answered}题`);
                return;
            }
            
            // 简单计算
            let total = 0;
            for (let key in userAnswers) {
                total += userAnswers[key];
            }
            
            const resultDiv = document.getElementById('resultPanel');
            if (resultDiv) {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h2>测评结果</h2>
                    <p>总分：${total}（平均分：${(total/48).toFixed(2)}）</p>
                    <p>${total < 100 ? '焦虑水平较低' : '焦虑水平较高'}</p>
                `;
            }
        }
        
        // 重置所有
        function resetAll() {
            if (confirm('确定要重置所有答案吗？')) {
                userAnswers = {};
                initializeQuestions();
                updateProgress();
                const resultDiv = document.getElementById('resultPanel');
                if (resultDiv) resultDiv.style.display = 'none';
            }
        }
        
        // 页面加载
        window.onload = function() {
            initializeQuestions();
            updateProgress();
        };
    </script>
</body>
</html>
