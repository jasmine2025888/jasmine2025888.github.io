
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>SCL-90症状自评量表（最终版）</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== CSS样式部分（保持绝对稳定，仅修改颜色主题） ========== */
        :root {
            --primary-color: #3a7bd5;
            --secondary-color: #00d2ff;
            --success-color: #4CAF50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --light-bg: #f8fafc;
            --card-bg: #ffffff;
            --text-dark: #2d3748;
            --text-light: #718096;
            --border-color: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f4f8 0%, #e6f0fa 100%);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(50, 100, 150, 0.08);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto;
        }

        .meta-info {
            background-color: #e8f4fc;
            padding: 15px 30px;
            color: var(--text-light);
            font-size: 0.9rem;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            border-bottom: 1px solid var(--border-color);
        }

        .meta-item {
            margin: 5px 15px;
        }

        .meta-item i {
            margin-right: 8px;
            color: var(--primary-color);
        }

        .disclaimer {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            margin: 25px;
            padding: 20px;
            border-radius: 10px;
            color: #856404;
            font-size: 0.95rem;
        }

        .disclaimer strong {
            color: #d39e00;
        }

        .progress-container {
            padding: 0 30px;
            margin-top: 20px;
        }

        .progress-bar {
            height: 8px;
            background-color: #edf2f7;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress {
            height: 100%;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .progress-text {
            text-align: right;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .questions-container {
            padding: 30px;
        }

        .question-card {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            display: none;
        }

        .question-card.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .question-number {
            background-color: var(--primary-color);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
            line-height: 1.5;
            flex-grow: 1;
            margin-left: 15px;
        }

        .options-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        .option-btn {
            padding: 16px 20px;
            background-color: white;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
            font-weight: 500;
            color: var(--text-dark);
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover {
            border-color: var(--primary-color);
            background-color: #f0f7ff;
            transform: translateY(-2px);
        }

        .option-btn.selected {
            border-color: var(--primary-color);
            background-color: #e8f4ff;
            color: var(--primary-color);
            font-weight: 600;
        }

        .option-btn.selected::after {
            content: '✓';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-weight: bold;
        }

        .score-label {
            display: block;
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: normal;
        }

        .buttons-container {
            padding: 0 30px 30px;
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .nav-btn, .submit-btn {
            padding: 16px 30px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
        }

        .nav-btn {
            background-color: #edf2f7;
            color: var(--text-dark);
        }

        .nav-btn:hover {
            background-color: #e2e8f0;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-btn i {
            margin: 0 8px;
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: 0 4px 12px rgba(58, 123, 213, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(58, 123, 213, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .result-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .result-content {
            background-color: white;
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalFadeIn 0.5s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            border-radius: 20px 20px 0 0;
            text-align: center;
        }

        .result-body {
            padding: 30px;
        }

        .score-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .score-card {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .score-value {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1;
            margin-bottom: 10px;
        }

        .score-label {
            font-size: 1rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        .interpretation {
            background-color: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            border-left: 4px solid var(--primary-color);
        }

        .interpretation h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .result-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .result-btn {
            flex: 1;
            padding: 16px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }

        .restart-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .restart-btn:hover {
            background-color: #2a6bc4;
        }

        .close-btn {
            background-color: #edf2f7;
            color: var(--text-dark);
        }

        .close-btn:hover {
            background-color: #e2e8f0;
        }

        footer {
            text-align: center;
            padding: 25px;
            color: var(--text-light);
            font-size: 0.9rem;
            border-top: 1px solid var(--border-color);
            background-color: #f9fbfd;
        }

        @media (max-width: 768px) {
            header h1 { font-size: 2rem; }
            .subtitle { font-size: 1rem; }
            .options-container { grid-template-columns: 1fr; }
            .buttons-container { flex-direction: column; }
            .nav-btn, .submit-btn { width: 100%; }
            .score-cards { grid-template-columns: 1fr; }
            .result-buttons { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-brain"></i> SCL-90症状自评量表（专业版）</h1>
            <p class="subtitle">专业心理测评工具 | 90项症状清单 | 科学评估心理健康状况</p>
        </header>

        <div class="meta-info">
            <div class="meta-item"><i class="fas fa-clock"></i> 预计时间：8-10分钟</div>
            <div class="meta-item"><i class="fas fa-question-circle"></i> 题目数量：30题</div>
            <div class="meta-item"><i class="fas fa-user-check"></i> 适用对象：6-18岁儿童青少年</div>
            <div class="meta-item"><i class="fas fa-stethoscope"></i> 评估人：父母或主要抚养者</div>
        </div>

        <div class="disclaimer">
            <p><strong><i class="fas fa-exclamation-triangle"></i> 重要提示：</strong>本测评结果为初步筛查参考，<strong>不能替代</strong>专业医生的临床诊断。若结果提示异常，建议携带此结果咨询<strong>儿童精神科、发育行为儿科或心理科医生</strong>，以获取权威评估和干预指导。</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
            <div class="progress-text">进度：<span id="progressText">0</span>/30</div>
        </div>

        <div class="questions-container" id="questionsContainer">
            <!-- 问题卡片将通过JavaScript动态生成 -->
        </div>

        <div class="buttons-container">
            <button class="nav-btn" id="prevBtn" onclick="prevQuestion()" disabled>
                <i class="fas fa-arrow-left"></i> 上一题
            </button>
            <button class="nav-btn" id="nextBtn" onclick="nextQuestion()">
                下一题 <i class="fas fa-arrow-right"></i>
            </button>
            <button class="submit-btn" id="submitBtn" onclick="submitTest()" disabled>
                <i class="fas fa-paper-plane"></i> 提交并查看结果
            </button>
        </div>

        <footer>
            <p>© 2023 儿童发展评估工具 | 本量表基于DSM-5诊断标准及SNAP-IV等常用临床量表整合设计 | 结果仅供参考</p>
            <p style="margin-top: 8px; font-size: 0.8rem;"><i class="fas fa-heartbeat"></i> 科学评估，理解孩子，助力成长</p>
        </footer>
    </div>

    <!-- 结果弹窗 -->
    <div class="result-modal" id="resultModal">
        <div class="result-content">
            <div class="result-header">
                <h2><i class="fas fa-chart-line"></i> 测评结果分析报告</h2>
                <p>基于您提供的回答，以下是量表的分析结果</p>
            </div>
            <div class="result-body">
                <div class="score-cards" id="scoreCardsContainer">
                    <!-- 分数卡片将通过JavaScript动态生成 -->
                </div>
                <div class="interpretation" id="interpretationContainer">
                    <!-- 解读内容将通过JavaScript动态生成 -->
                </div>
                <div class="result-buttons">
                    <button class="result-btn restart-btn" onclick="restartTest()">
                        <i class="fas fa-redo"></i> 重新开始测评
                    </button>
                    <button class="result-btn close-btn" onclick="closeResult()">
                        <i class="fas fa-times"></i> 关闭结果
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== JavaScript代码部分（核心修改区） ==========
        // 1. 修改题目数据
     ;const sc190Questions = {
    scale: "SCL-90症状自评量表",
    description: "包含90个项目，涵盖感觉、情感、思维、意识、行为、睡眠习惯等心理健康症状。用于评估个体在一周内的心理症状及其严重程度。",
    items: [
        { id: 1, text: "头痛", dimension: "躯体化" },
        { id: 2, text: "神经过敏，心中不踏实", dimension: "强迫症状" },
        { id: 3, text: "头脑中有不必要的想法或字句盘旋", dimension: "强迫症状" },
        { id: 4, text: "头晕或昏倒", dimension: "躯体化" },
        { id: 5, text: "对异性的兴趣减退", dimension: "性症状" },
        { id: 6, text: "对旁人责备求全", dimension: "敌对" },
        { id: 7, text: "感到别人能控制您的思想", dimension: "偏执" },
        { id: 8, text: "责怪别人制造麻烦", dimension: "敌对" },
        { id: 9, text: "忘记性大", dimension: "强迫症状" },
        { id: 10, text: "担心自己的衣饰整齐及仪态的端正", dimension: "强迫症状" },
        // ... 中间题目按SCL-90实际题目填写 ...
        { id: 86, text: "感到要赶快把事情做完", dimension: "强迫症状" },
        { id: 87, text: "感到自己的身体有严重问题", dimension: "躯体化" },
        { id: 88, text: "从未感到和其他人很亲近", dimension: "人际关系敏感" },
        { id: 89, text: "感到自己有罪", dimension: "抑郁" },
        { id: 90, text: "感到自己的脑子有毛病", dimension: "精神病性" }
    ]
};
        // 评分选项 (0-3分)
        const ratingOptions = [
              { text: "没有", score: 0, desc: "自觉无该项症状" },
    { text: "很轻", score: 1, desc: "自觉有该项症状，但发生不频繁、不严重" },
    { text: "中等", score: 2, desc: "自觉有该项症状，严重程度为轻到中度" },
    { text: "偏重", score: 3, desc: "自觉常有该项症状，程度为中到严重" },
    { text: "严重", score: 4, desc: "自觉该项症状的频度和强度都十分严重" }
        ];

        // ========== 以下是稳定不变的逻辑部分，请勿修改 ==========
        let currentQuestion = 0;
        let userAnswers = new Array(adhdQuestions.items.length).fill(null);

        // 初始化问题
        function initializeQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            adhdQuestions.items.forEach((q, index) => {
                const questionCard = document.createElement('div');
                questionCard.className = `question-card ${index === 0 ? 'active' : ''}`;
                questionCard.id = `q${index}`;

                let optionsHTML = '';
                ratingOptions.forEach(option => {
                    optionsHTML += `
                        <div class="option-btn" onclick="selectOption(${index}, ${option.score})">
                            ${option.text}
                            <span class="score-label">${option.desc} (${option.score}分)</span>
                        </div>
                    `;
                });

                questionCard.innerHTML = `
                    <div class="question-header">
                        <div class="question-number">${q.id}</div>
                        <div class="question-text">${q.text}</div>
                    </div>
                    <div class="options-container">
                        ${optionsHTML}
                    </div>
                `;
                container.appendChild(questionCard);
            });

            updateProgress();
            updateButtons();
        }

        // 选择选项
        function selectOption(qIndex, score) {
            // 清除同一问题下其他选项的选中状态
            const questionCard = document.getElementById(`q${qIndex}`);
            const allOptions = questionCard.querySelectorAll('.option-btn');
            allOptions.forEach(opt => opt.classList.remove('selected'));

            // 设置当前选项为选中状态
            const selectedOption = Array.from(allOptions).find(opt => {
                const btnText = opt.textContent.split('\n')[0].trim();
                const matchingOption = ratingOptions.find(o => o.text === btnText);
                return matchingOption && matchingOption.score === score;
            });
            if (selectedOption) selectedOption.classList.add('selected');

            userAnswers[qIndex] = score;
            updateProgress();
            updateButtons();

            // 自动跳转到下一题（如果不是最后一题）
            if (qIndex === currentQuestion && qIndex < adhdQuestions.items.length - 1) {
                setTimeout(() => nextQuestion(), 300);
            }
        }

        // 更新进度条
        function updateProgress() {
            const answeredCount = userAnswers.filter(ans => ans !== null).length;
            const totalQuestions = adhdQuestions.items.length;
            const progressPercent = (answeredCount / totalQuestions) * 100;

            document.getElementById('progressBar').style.width = `${progressPercent}%`;
            document.getElementById('progressText').textContent = `${answeredCount}/${totalQuestions}`;

            // 更新提交按钮状态
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = answeredCount < totalQuestions;
        }

        // 更新导航按钮
        function updateButtons() {
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('nextBtn').disabled = currentQuestion === adhdQuestions.items.length - 1;
        }

        // 上一题
        function prevQuestion() {
            if (currentQuestion > 0) {
                document.getElementById(`q${currentQuestion}`).classList.remove('active');
                currentQuestion--;
                document.getElementById(`q${currentQuestion}`).classList.add('active');
                updateButtons();
            }
        }

        // 下一题
        function nextQuestion() {
            if (currentQuestion < sc190Questions.items.length - 1) {
                document.getElementById(`q${currentQuestion}`).classList.remove('active');
                currentQuestion++;
                document.getElementById(`q${currentQuestion}`).classList.add('active');
                updateButtons();
            }
        }

        // ========== 核心修改区：计算分数和生成结果的逻辑 ==========
        function calculateScore() {
    let totalScore = 0;
    let positiveItems = 0;
    const answers = userAnswers;
    
    answers.forEach(score => {
        totalScore += score || 0;
        if (score > 0) positiveItems++;
    });

    const totalSymptomIndex = totalScore / 90;

    // 计算各因子分
    const factorScores = {};
    
    // SCL-90因子定义
    const scl90Factors = {
        "躯体化": [0, 3, 11, 18, 26, 39, 48, 51, 55, 56, 86],
        "强迫症状": [1, 2, 8, 9, 37, 44, 45, 64, 85],
        "人际关系敏感": [4, 20, 28, 35, 36, 60, 68, 76, 87],
        "抑郁": [13, 14, 19, 25, 29, 31, 53, 58, 70, 78, 84, 88],
        "焦虑": [10, 16, 22, 30, 38, 46, 52, 71, 74, 77],
        "敌对": [5, 7, 23, 32, 62, 66, 73, 80],
        "恐怖": [12, 24, 33, 49, 69, 72, 81],
        "偏执": [6, 17, 21, 34, 42, 75, 82],
        "精神病性": [15, 61, 67, 79, 83, 89],
        "睡眠饮食": [43, 59, 63, 65]
    };

    for (const [factorName, itemIndices] of Object.entries(scl90Factors)) {
        let factorTotal = 0;
        let itemCount = itemIndices.length;
        
        itemIndices.forEach(index => {
            factorTotal += answers[index] || 0;
        });
        
        const factorAverage = itemCount > 0 ? (factorTotal / itemCount).toFixed(2) : 0;
        
        let severity, color;
        if (factorAverage >= 3.0) {
            severity = "重度症状";
            color = "#f44336";
        } else if (factorAverage >= 2.0) {
            severity = "中度症状";
            color = "#ff9800";
        } else if (factorAverage >= 1.5) {
            severity = "轻度症状";
            color = "#ffc107";
        } else {
            severity = "正常范围";
            color = "#4CAF50";
        }
        
        factorScores[factorName] = {
            score: factorTotal,
            avg: factorAverage,
            items: itemCount,
            severity: severity,
            color: color
        };
    }

    // 总体结果判断
    let overallSeverity, overallColor;
    if (totalSymptomIndex >= 3.0) {
        overallSeverity = "重度心理困扰";
        overallColor = "#f44336";
    } else if (totalSymptomIndex >= 2.0) {
        overallSeverity = "中度心理困扰";
        overallColor = "#ff9800";
    } else if (totalSymptomIndex >= 1.5) {
        overallSeverity = "轻度心理困扰";
        overallColor = "#ffc107";
    } else {
        overallSeverity = "正常范围";
        overallColor = "#4CAF50";
    }

    return {
        total: {
            score: totalScore,
            avg: totalSymptomIndex.toFixed(2),
            items: 90,
            positiveItems: positiveItems,
            severity: overallSeverity,
            color: overallColor
        },
        factors: factorScores
    };
}

            // 计算平均分（每题最高3分）
            const attentionAvg = attentionItems > 0 ? (attentionScore / attentionItems).toFixed(2) : 0;
            const hyperAvg = hyperItems > 0 ? (hyperScore / hyperItems).toFixed(2) : 0;
            const impulseAvg = impulseItems > 0 ? (impulseScore / impulseItems).toFixed(2) : 0;
            const behaviorAvg = behaviorItems > 0 ? (behaviorScore / behaviorItems).toFixed(2) : 0;
            const totalAvg = ((attentionScore + hyperScore + impulseScore + behaviorScore) / adhdQuestions.items.length).toFixed(2);

            // 判断风险等级 (基于SNAP-IV常用切分点: 平均分1.6以上为中度风险)
            function getRiskLevel(avgScore) {
                if (avgScore >= 2.0) return { level: "高风险", color: "#f44336" };
                if (avgScore >= 1.6) return { level: "中度风险", color: "#ff9800" };
                if (avgScore >= 1.0) return { level: "边缘状态", color: "#ffc107" };
                return { level: "正常范围", color: "#4CAF50" };
            }

            const attentionRisk = getRiskLevel(attentionAvg);
            const hyperRisk = getRiskLevel(hyperAvg);
            const impulseRisk = getRiskLevel(impulseAvg);
            const behaviorRisk = getRiskLevel(behaviorAvg);
            const totalRisk = getRiskLevel(totalAvg);

            return {
                scores: {
                    注意: { score: attentionScore, avg: attentionAvg, risk: attentionRisk, items: attentionItems },
                    多动: { score: hyperScore, avg: hyperAvg, risk: hyperRisk, items: hyperItems },
                    冲动: { score: impulseScore, avg: impulseAvg, risk: impulseRisk, items: impulseItems },
                    行为: { score: behaviorScore, avg: behaviorAvg, risk: behaviorRisk, items: behaviorItems },
                    总分: { score: attentionScore + hyperScore + impulseScore + behaviorScore, avg: totalAvg, risk: totalRisk, items: adhdQuestions.items.length }
                }
            };
        }

        // 生成结果报告
        function generateResultReport(result) function generateResultReport(result) {
    const scoreCardsContainer = document.getElementById('scoreCardsContainer');
    const interpretationContainer = document.getElementById('interpretationContainer');

    // 生成分数卡片
    let scoreCardsHTML = '';
    
    // 总分卡片
    scoreCardsHTML += `
        <div class="score-card">
            <div class="score-value" style="color: ${result.total.color};">${result.total.avg}</div>
            <div class="score-label" style="font-weight: 600; color: ${result.total.color};">${result.total.severity}</div>
            <div class="score-label">总症状指数</div>
            <div class="score-label">阳性项目：${result.total.positiveItems}/90</div>
        </div>
    `;

    // 各因子卡片（显示前5个主要因子）
    let factorCount = 0;
    for (const [factorName, data] of Object.entries(result.factors)) {
        if (factorCount < 5) {
            scoreCardsHTML += `
                <div class="score-card">
                    <div class="score-value" style="color: ${data.color};">${data.avg}</div>
                    <div class="score-label" style="font-weight: 600; color: ${data.color};">${data.severity}</div>
                    <div class="score-label">${factorName}</div>
                    <div class="score-label">${data.score}分 / ${data.items * 4}分</div>
                </div>
            `;
            factorCount++;
        }
    }
    scoreCardsContainer.innerHTML = scoreCardsHTML;

    // 生成解读文本
    const totalRisk = result.total.severity;
    let interpretationText = '';

    if (totalRisk.includes("重度") || totalRisk.includes("中度")) {
        interpretationText = `
            <h3><i class="fas fa-exclamation-circle"></i> 筛查结果提示：存在明显心理症状</h3>
            <p>根据SCL-90评估，您的总症状指数为 <strong>${result.total.avg}</strong>，阳性项目数为 <strong>${result.total.positiveItems}/90</strong>，提示存在${totalRisk.includes("重度") ? "重度" : "中度"}心理困扰。</p>
            
            <p><strong>主要症状维度：</strong></p>
            <ul>
                ${Object.entries(result.factors)
                    .filter(([_, data]) => parseFloat(data.avg) >= 2.0)
                    .map(([name, data]) => `<li><strong>${name}</strong>：${data.avg}分（${data.severity}）</li>`)
                    .join('')}
            </ul>
            
            <p><strong>建议：</strong></p>
            <ol>
                <li><strong>寻求专业评估</strong>：建议预约心理科、精神科医生或心理咨询师进行详细评估。</li>
                <li><strong>关注高危维度</strong>：针对得分较高的症状维度，进行针对性的心理调节。</li>
                <li><strong>建立支持系统</strong>：与家人朋友沟通，寻求社会支持。</li>
                <li><strong>考虑心理咨询</strong>：如有需要，可寻求专业心理咨询帮助。</li>
            </ol>
        `;
    } else if (totalRisk.includes("轻度")) {
        interpretationText = `
            <h3><i class="fas fa-info-circle"></i> 筛查结果提示：轻度心理困扰</h3>
            <p>您的总症状指数为 <strong>${result.total.avg}</strong>，阳性项目数为 <strong>${result.total.positiveItems}/90</strong>，提示存在轻度心理困扰，但仍在可接受范围。</p>
            
            <p><strong>建议：</strong></p>
            <ul>
                <li><strong>自我调节</strong>：通过运动、冥想、规律作息等方式缓解压力。</li>
                <li><strong>关注变化</strong>：如症状持续或加重，建议咨询专业人士。</li>
                <li><strong>定期评估</strong>：建议1-3个月后重新评估，追踪变化。</li>
            </ul>
        `;
    } else {
        interpretationText = `
            <h3><i class="fas fa-check-circle"></i> 筛查结果提示：正常范围内</h3>
            <p>您的总症状指数为 <strong>${result.total.avg}</strong>，阳性项目数为 <strong>${result.total.positiveItems}/90</strong>，各项心理症状均在正常范围内。</p>
            
            <p><strong>说明：</strong></p>
            <ul>
                <li>本结果为近期（一周内）的心理状态评估。</li>
                <li>继续保持健康的生活方式和良好的心理状态。</li>
                <li>如遇重大生活事件或持续压力，建议定期评估。</li>
            </ul>
        `;
    }

    interpretationContainer.innerHTML = interpretationText;
}
            scoreCardsContainer.innerHTML = scoreCardsHTML;

            // 2. 生成解读文本
            const totalRisk = result.scores.总分.risk.level;
            let interpretationText = '';

            if (totalRisk === "高风险" || totalRisk === "中度风险") {
                interpretationText = `
                    <h3><i class="fas fa-exclamation-circle"></i> 筛查结果提示：存在明显ADHD相关症状风险</h3>
                    <p>根据您的评估，孩子在<strong>注意力、多动/冲动及行为管理</strong>等多个维度上表现出中度至高度的困难，与ADHD（注意缺陷多动障碍）的核心症状有较高吻合度。</p>
                    <p><strong>建议行动：</strong></p>
                    <ul>
                        <li><strong>寻求专业评估：</strong>强烈建议您携带此结果，预约<strong>儿童精神科、发育行为儿科或心理科</strong>进行全面的临床诊断评估。专业的诊断是获得有效帮助的第一步。</li>
                        <li><strong>收集日常信息：</strong>就诊前，记录孩子在学校和家庭中的具体行为表现、发生频率和情境，有助于医生更准确判断。</li>
                        <li><strong>了解支持资源：</strong>ADHD可以通过行为治疗、家长培训、学校干预以及必要时在医生指导下的药物治疗进行有效管理。</li>
                    </ul>
                `;
            } else if (totalRisk === "边缘状态") {
                interpretationText = `
                    <h3><i class="fas fa-info-circle"></i> 筛查结果提示：处于边缘状态</h3>
                    <p>评估显示孩子在部分维度（如${getHighestDimension(result.scores)}）存在一定困难，但尚未达到典型的临床水平。这可能是发展过程中的波动，或受环境、情绪等因素暂时影响。</p>
                    <p><strong>建议行动：</strong></p>
                    <ul>
                        <li><strong>持续观察：</strong>在接下来的1-3个月内，有意识地观察孩子在相关情境下的表现是否有变化。</li>
                        <li><strong>优化环境支持：</strong>尝试提供更结构化的日常安排、减少干扰、分解任务、给予清晰指令和及时正向反馈。</li>
                        <li><strong>如有疑虑，可咨询：</strong>如果困难持续存在或影响到学习、社交，仍建议咨询相关专业人士获取指导。</li>
                    </ul>
                `;
            } else {
                interpretationText = `
                    <h3><i class="fas fa-check-circle"></i> 筛查结果提示：正常范围内</h3>
                    <p>根据当前评估，孩子在注意力、活动水平和行为控制方面的表现总体在正常发展范围之内。未发现明显的ADHD核心症状。</p>
                    <p><strong>说明与建议：</strong></p>
                    <ul>
                        <li>本结果为基于近期行为的筛查，不能完全排除未来出现变化的可能性。</li>
                        <li>继续保持良好的亲子沟通和积极的教养方式。如果未来出现新的、持续性的困扰，可重新评估或咨询专业人士。</li>
                        <li>每个孩子都有独特的发展节奏和气质，接纳个体差异，关注优势发展。</li>
                    </ul>
                `;
            }

            interpretationContainer.innerHTML = interpretationText;
        }

        // 辅助函数：获取分数最高的维度
        function getHighestDimension(scores) {
            let highestDim = '';
            let highestAvg = 0;
            for (const [dim, data] of Object.entries(scores)) {
                if (dim !== '总分' && parseFloat(data.avg) > highestAvg) {
                    highestAvg = parseFloat(data.avg);
                    highestDim = dim;
                }
            }
            return highestDim || '某些';
        }

        // 提交测试
        function submitTest() {
            const allAnswered = userAnswers.every(ans => ans !== null);
            if (!allAnswered) {
                alert('请完成所有题目后再提交。');
                return;
            }

            const result = calculateScore();
            generateResultReport(result);

            // 显示结果弹窗
            document.getElementById('resultModal').style.display = 'flex';
            // 滚动到顶部
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 重新开始测试
        function restartTest() {
            if (confirm('确定要重新开始测评吗？当前答案将被清空。')) {
                userAnswers = new Array(adhdQuestions.items.length).fill(null);
                currentQuestion = 0;
                closeResult();
                initializeQuestions();
                // 滚动到顶部
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // 关闭结果弹窗
        function closeResult() {
            document.getElementById('resultModal').style.display = 'none';
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            initializeQuestions();
            // 允许回车键翻页
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    if (currentQuestion < adhdQuestions.items.length - 1) {
                        nextQuestion();
                    } else {
                        const submitBtn = document.getElementById('submitBtn');
                        if (!submitBtn.disabled) submitTest();
                    }
                }
            });
        });
    </script>
</body>
</html>
